nasm -f elf32 multiboot.asm -o multiboot.o
nasm -f elf32 start.asm -o start.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c kernel.c -o kernel.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c std/stdlib.c -o stdlib.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c drivers/screen.c -o screen.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c drivers/keyboard.c -o keyboard.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c std/string.c -o string.o
i686-elf-gcc -ffreestanding -O2 -nostdlib -c shell.c -o shell.o
i686-elf-ld -T linker.ld -o kernel.bin multiboot.o start.o kernel.o stdlib.o screen.o keyboard.o string.o shell.o
mkdir -p iso/boot/
cp kernel.bin iso/boot/
mkdir -p iso/boot/grub
cat > iso/boot/grub/grub.cfg << EOF
set timeout=0
set default=0

menuentry "My Kernel" {
multiboot /boot/kernel.bin
boot
}
EOF
grub-mkrescue -o kernel.iso iso
qemu-system-i386 -cdrom kernel.iso